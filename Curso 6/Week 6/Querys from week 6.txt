SELECT CCD.CASE_NUMBER, CCD.primary_type, CCD.COMMUNITY_AREA_NUMBER, CD.COMMUNITY_AREA_NAME
FROM CHICAGO_CRIME_DATA as CCD 
INNER JOIN CENSUS_DATA AS CD ON CCD.COMMUNITY_AREA_NUMBER = CD.COMMUNITY_AREA_NUMBER 	
WHERE CCD.COMMUNITY_AREA_NUMBER = 18


SELECT CCD.CASE_NUMBER, CCD.primary_type, CCD.COMMUNITY_AREA_NUMBER, CD.COMMUNITY_AREA_NAME
FROM CHICAGO_CRIME_DATA as CCD 
INNER JOIN CENSUS_DATA AS CD ON CCD.COMMUNITY_AREA_NUMBER = CD.COMMUNITY_AREA_NUMBER 	
WHERE LOCATION_DESCRIPTION 	LIKE '%SCHOOL%'


SELECT CCD.CASE_NUMBER, CCD.primary_type, CCD.COMMUNITY_AREA_NUMBER
FROM CHICAGO_CRIME_DATA as CCD 
FULL OUTER JOIN CENSUS_DATA AS CD ON CCD.COMMUNITY_AREA_NUMBER = CD.COMMUNITY_AREA_NUMBER 
WHERE CD.COMMUNITY_AREA_NAME IN ('Oakland', 'Armour Square', 'Edgewater', 'CHICAGO')



_____________________________________________________________________________________________

1
SELECT CPS.NAME_OF_SCHOOL, CPS.AVERAGE_STUDENT_ATTENDANCE, CPS.COMMUNITY_AREA_NAME
FROM chicago_public_schools_data AS CPS 
LEFT OUTER JOIN CENSUS_DATA AS CD ON CD.COMMUNITY_AREA_NUMBER = CPS.COMMUNITY_AREA_NUMBER
WHERE CD.HARDSHIP_INDEX = 98

SELECT CCD.CASE_NUMBER, CCD.primary_type, CD.COMMUNITY_AREA_NAME, CCD.LOCATION_DESCRIPTION
FROM CHICAGO_CRIME_DATA as CCD 
LEFT OUTER JOIN CENSUS_DATA AS CD ON CCD.COMMUNITY_AREA_NUMBER = CD.COMMUNITY_AREA_NUMBER 	
WHERE LOCATION_DESCRIPTION 	LIKE '%SCHOOL%'

2
CREATE VIEW  PUBLIC_SCHOOL_CHICAGO (School_Name, Safety_Rating, Family_Rating, Environment_Rating, Instruction_Rating, Leaders_Rating, Teachers_Rating)
AS SELECT NAME_OF_SCHOOL, Safety_Icon, Family_Involvement_Icon, Environment_Icon, Instruction_Icon, Leaders_Icon, Teachers_Icon
FROM CHICAGO_PUBLIC_SCHOOLS_DATA;
SELECT * FROM PUBLIC_SCHOOL_CHICAGO;

3.1
--#SET TERMINATOR @
CREATE PROCEDURE UPDATE_LEADERS_SCORE(
IN SCHOOL_ID INTEGER,
IN IN_LEADER_SCORE INTEGER)

LANGUAGE SQL 
READS SQL DATA 

DYNAMIC RESULT SETS 1 

BEGIN 
	
	DECLARE C1 CURSOR 
	WITH RETURN FOR 
	
	SELECT * FROM CHICAGO_PUBLIC_SCHOOLS_DATA;
	
	OPEN C1;
	
END 

@

3.2
--#SET TERMINATOR @
CREATE OR REPLACE PROCEDURE UPDATE_LEADERS_SCORE(
    IN in_SCHOOL_ID INTEGER,
    IN in_LEADER_SCORE INTEGER)
LANGUAGE SQL
MODIFIES SQL DATA
BEGIN
    UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA
    SET Leaders_Score = in_LEADER_SCORE
    WHERE SCHOOL_ID = in_SCHOOL_ID;
END
@

3.3

--#SET TERMINATOR @
CREATE OR REPLACE PROCEDURE UPDATE_LEADERS_SCORE(
    IN IN_SCHOOL_ID INTEGER, IN IN_LEADER_SCORE INTEGER)

LANGUAGE SQL 
MODIFIES SQL DATA 

BEGIN 
    UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
    SET LEADERS_SCORE = IN_LEADER_SCORE
    WHERE SCHOOL_ID = IN_SCHOOL_ID;

    IF IN_LEADER_SCORE > 0 AND IN_LEADER_SCORE < 20 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Very Weak';
    ELSEIF IN_LEADER_SCORE < 40 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Weak';
    ELSEIF IN_LEADER_SCORE < 60 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Average';
    ELSEIF IN_LEADER_SCORE < 80 THEN
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Strong';
    ELSEIF IN_LEADER_SCORE < 100 THEN
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Very Strong';
    END IF;
END 
@

4.2
--#SET TERMINATOR @
CREATE OR REPLACE PROCEDURE UPDATE_LEADERS_SCORE(
    IN IN_SCHOOL_ID INTEGER, IN IN_LEADER_SCORE INTEGER)

LANGUAGE SQL 
MODIFIES SQL DATA 

BEGIN 
    UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
    SET LEADERS_SCORE = IN_LEADER_SCORE
    WHERE SCHOOL_ID = IN_SCHOOL_ID;

    IF IN_LEADER_SCORE > 0 AND IN_LEADER_SCORE < 20 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Very Weak';
    ELSEIF IN_LEADER_SCORE < 40 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Weak';
    ELSEIF IN_LEADER_SCORE < 60 THEN 
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Average';
    ELSEIF IN_LEADER_SCORE < 80 THEN
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Strong';
    ELSEIF IN_LEADER_SCORE < 100 THEN
        UPDATE CHICAGO_PUBLIC_SCHOOLS_DATA 
        SET LEADERS_ICON = 'Very Strong';
    ELSE
    	ROLLBACK WORK;
    END IF;
    	COMMIT WORK;
END 
@


